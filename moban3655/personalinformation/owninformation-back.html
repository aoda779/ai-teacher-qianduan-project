<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>个人管理</title>
    <link rel="stylesheet" href="../layui/css/layui.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,700">
    <!-- https://fonts.google.com/specimen/Roboto -->
    <link rel="stylesheet" href="../css/fontawesome.min.css">
    <!-- https://fontawesome.com/ -->
    <link rel="stylesheet" href="../css/bootstrap.min.css">
    <!-- https://getbootstrap.com/ -->
    <link rel="stylesheet" href="../css/templatemo-style.css">
    <link rel="stylesheet" href="../iconfont/iconfont.css">
    <link rel="stylesheet" href="../iconfont2/iconfont.css">
    <link rel="stylesheet" href="../css/scoringpaper.css">
    <!--
	Product Admin CSS Template
	https://templatemo.com/tm-524-product-admin
	-->
    <style>
        .layui-form-label {
            position: relative;
            float: left;
            display: block;
            padding: 9px 15px;
            width: 110px;
            font-weight: 400;
            line-height: 20px;
            text-align: right;
        }
    </style>
</head>

<body id="reportsPage">
<div class="" id="home">
    <nav class="navbar navbar-expand-xl">
        <div class="container h-100">
            <a class="navbar-brand" href="#">
                <h1 class="tm-site-title mb-0">智阅专辅</h1>
            </a>
            <button class="navbar-toggler ml-auto mr-0" type="button" data-toggle="collapse"
                    data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                    aria-label="Toggle navigation">
                <i class="fas fa-bars tm-nav-icon"></i>
            </button>

            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav mx-auto h-100">
                    <li class="nav-item">
                        <a class="nav-link" href="../index.html">
                            <i class="fas iconfont icon-biaoshilei_yonghuzu
                          "></i> 考生管理
                            <span class="sr-only">(current)</span>
                        </a>
                    </li>

                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="../papersubmit.html" id="navbarDropdown" role="button"
                           data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class="far iconfont icon-jiqiren"></i>
                            <span>
                                智慧阅卷 <i class="fas fa-angle-down"></i>
                            </span>
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="../smartscoring/papersubmit.html">试卷上传</a>
                            <a class="dropdown-item" href="../smartscoring/rules.html">批阅规则</a>
                            <a class="dropdown-item" href="../smartscoring/papercheck.html">阅卷复核</a>
                            <a class="dropdown-item" href="../smartscoring/papermanage.html">试卷管理</a>

                        </div>
                    </li>

                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button"
                           data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class="fas iconfont icon-shuji
                          "></i>
                            <span>
                              教师阅卷 <i class="fas fa-angle-down"></i>
                          </span>
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="../teacherscoring/paperread.html">阅卷</a>

                            <a class="dropdown-item" href="#">阅卷结果</a>

                        </div>
                    </li>

                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button"
                           data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class="fas iconfont icon-anquan
                          "></i>
                            <span>
                              数据报告 <i class="fas fa-angle-down"></i>
                          </span>
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="../scoringpaper/studentreport.html">学生报告</a>
                            <a class="dropdown-item" href="../scoringpaper/classreport.html">班级报告</a>
                            <a class="dropdown-item" href="../scoringpaper/gradescoring.html">科目报告</a>

                        </div>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button"
                           data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class="fas iconfont icon-yonghu
                            "></i>
                            <span>
                                个人信息 <i class="fas fa-angle-down"></i>
                            </span>
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="../personalinformation/owninformation.html">个人信息</a>
                            <a class="dropdown-item" href="../personalinformation/classinformation.html">班级管理</a>

                        </div>
                    </li>
                </ul>
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link d-block" href="../login.html">
                            <b>退出登录</b>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- 下面是四个按钮 -->
    <div class="button4-container" style="margin-left: 560px;">
        <button class="button4" onclick="navigateTo('owninformation.html')">个人信息</button>
        <button class="button4" onclick="navigateTo('classinformation.html')">班级管理</button>

    </div>
    <div class="container">

        <div class="studentmanagement" style="display: flex;flex-direction: column;">
            <div style="display: flex;flex-direction: row;">
                <div style="
                    margin-top: 30px;
                    margin-left: 40px;
                    width: 130px;
                    height: 130px;
                    opacity: 1;
                    background: rgba(255, 255, 255, 1);">
                    <img src="../img/820f054b59e755fdea75c98f2c514a89.jpeg" width="130" height="130">
                </div>
                <div style="font-size: 38px;width: 100px;margin-top: 39px;margin-left: 10px;">
                    名字账号
                </div>
            </div>

            <div class="title3" style="margin-left: 400px;margin-top: 20px;">
                个人资料
            </div>
            <form class="layui-form" lay-filter="demo-val-filter" style="margin-top: 5%;width: 95%;">
                <div class="layui-form-item">
                    <label class="layui-form-label">试卷名称</label>
                    <div class="layui-input-block">
                        <input type="text" name="name" lay-verify="required" placeholder="请输入" autocomplete="off"
                               class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">班级</label>
                    <div class="layui-input-block">
                        <select name="clazzId" id="clazzId" lay-filter="aihao">
                            <option value="">请选择</option>
                        </select>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">科目</label>
                    <div class="layui-input-block">
                        <input type="text" name="name" lay-verify="required" placeholder="请输入" autocomplete="off"
                               class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">试卷名称</label>
                    <div class="layui-input-block">
                        <input type="text" name="name" lay-verify="required" placeholder="请输入" autocomplete="off"
                               class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">试卷名称</label>
                    <div class="layui-input-block">
                        <input type="text" name="name" lay-verify="required" placeholder="请输入" autocomplete="off"
                               class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">试卷名称</label>
                    <div class="layui-input-block">
                        <input type="text" name="name" lay-verify="required" placeholder="请输入" autocomplete="off"
                               class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item layui-form-text">
                    <label class="layui-form-label">普通文本域</label>
                    <div class="layui-input-block">
                        <textarea placeholder="请输入内容" class="layui-textarea"></textarea>
                    </div>
                </div>
                <div class="layui-form-item">
                    <div class="layui-input-block">
                        <button type="submit" class="layui-btn" lay-submit lay-filter="demo1">立即提交</button>
                        <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                    </div>
                </div>
            </form>
        </div>


    </div>
</div>
    <script>
        function setActive(button) {
            // 移除所有按钮的 'active' 类
            document.querySelectorAll('.button4').forEach(btn => btn.classList.remove('active4'));
            // 给点击的按钮添加 'active' 类
            button.classList.add('active4');
        }
    </script>
    <script>
        // 这里是类选择器
        document.querySelectorAll('.toggleButton').forEach(button => {
            button.addEventListener('click', function () {
                this.classList.toggle('clicked');
            });
        });
    </script>

    <script>
        function navigateTo(url) {
            window.location.href = url;
        }
    </script>
    <script src="../js/jquery-3.3.1.min.js"></script>
    <!-- https://jquery.com/download/ -->
    <script src="../js/moment.min.js"></script>
    <!-- https://momentjs.com/ -->
    <script src="../js/Chart.min.js"></script>
    <!-- http://www.chartjs.org/docs/latest/ -->
    <script src="../js/bootstrap.min.js"></script>
    <!-- https://getbootstrap.com/ -->
    <script src="../js/tooplate-scripts.js"></script>
    <script>
        Chart.defaults.global.defaultFontColor = 'white';
        let ctxLine,
            ctxBar,
            ctxPie,
            optionsLine,
            optionsBar,
            optionsPie,
            configLine,
            configBar,
            configPie,
            lineChart,
        barChart, pieChart;
        // DOM is ready
        $(function () {
            drawLineChart(); // Line Chart
            drawBarChart(); // Bar Chart
            drawPieChart(); // Pie Chart

            $(window).resize(function () {
                updateLineChart();
                updateBarChart();
            });
        })
    </script>

    <script src="../layui/layui.js"></script>
    <script>
        layui.use(['form', 'laydate', 'util', 'jquery'], function () {
            var form = layui.form;
            var layer = layui.layer;
            let token = localStorage.getItem('token');
            var laydate = layui.laydate;

            // 日期
            laydate.render({
                elem: '#date'
            });

            // 获取 URL 参数
            function getUrlParams() {
                const url = new URL(window.location.href);
                return new URLSearchParams(url.search);
            }

            let params = getUrlParams();
            let id = params.get('id');

            // 表单赋值
            let assignment = function () {
                layui.$.ajax({
                    url: 'http://localhost:8080/clazz-info/get/list',
                    type: 'GET',
                    headers: {
                        token: token
                    },
                    success: function (result) {
                        console.log(result);
                        if (result.code == 200) {
                            console.log('查询成功');
                            let selectEvent = layui.$('#clazzId')[0];
                            let data = result.data;
                            if (data) {
                                for (let i = 0; i < data.length; i++) {
                                    let option = document.createElement("option");
                                    option.value = data[i].id;
                                    option.text = data[i].clazzName;
                                    selectEvent.appendChild(option);
                                }
                            }
                            form.render('select');
                        }
                    },
                    error: function (err) {
                        console.error('请求失败:', err);
                        layer.msg('请求失败');
                    }
                })
            }

            // 渲染表单
            form.render();
            // 渲染完毕后自动执行的方法
            assignment();

            // 提交事件
            form.on('submit(demo1)', function (data) {
                var field = data.field; // 获取表单字段值
                if (id !== 'undefined') {
                    field.id = id;
                }
                // 显示填写结果，仅作演示用
                // layer.alert(JSON.stringify(field), {
                //     title: '当前填写的字段值'
                // });
                let index = parent.layer.getFrameIndex(window.name);

                // 此处可执行 Ajax 等操作
                layui.$.ajax({
                    url: 'http://localhost:8080/student-info/save-or-up',
                    type: 'POST',
                    contentType: 'application/json; charset=UTF-8', // 设置内容类型为 JSON
                    data: JSON.stringify(field),
                    async: false,
                    headers: {
                        token: token
                    },
                    success: function (result) {
                        console.log(result);
                        if (result.code == 200) {
                            console.log('新增成功');
                            parent.layer.close(index);
                        } else {
                            layer.msg('新增失败')
                        }
                    },
                    error: function (err) {
                        console.error('请求失败:', err);
                        layer.msg('新增失败');
                    }
                });
                // …
                return false; // 阻止默认 form 跳转
            });

        });
    </script>
</body>

</html>
